@import '../../node_modules/@primer/css/support';

@function blend($color, $background-color: #fff) {
  $red: ((1 - alpha($color)) * red($background-color)) + (alpha($color) * red($color));
  $green: ((1 - alpha($color)) * green($background-color)) + (alpha($color) * green($color));
  $blue: ((1 - alpha($color)) * blue($background-color)) + (alpha($color) * blue($color));
  @return rgb($red, $green, $blue);
}

@mixin linear-gradient($color-start, $color-stop, $color-stop-percentage: 90%) {
  background-image: -webkit-linear-gradient(top, $color-start, $color-stop $color-stop-percentage);
  background-image: -moz-linear-gradient(top, $color-start, $color-stop $color-stop-percentage);
  background-image: linear-gradient(180deg, $color-start, $color-stop $color-stop-percentage);
}

@mixin -ms-filter-linear-gradient($color-start, $color-stop, $color-stop-percentage: 90%) {
  $red: red($color-start) + (red($color-stop) - red($color-start)) / $color-stop-percentage * 100%;
  $green: green($color-start) + (green($color-stop) - green($color-start)) / $color-stop-percentage * 100%;
  $blue: blue($color-start) + (blue($color-stop) - blue($color-start)) / $color-stop-percentage * 100%;
  $color-stop: rgb($red, $green, $blue);
  -ms-filter: "progid:DXImageTransform.Microsoft.Gradient(startColorstr='#{ie-hex-str($color-start)}', endColorstr='#{ie-hex-str($color-stop)}')";
  *filter: progid:DXImageTransform.Microsoft.Gradient(startColorstr='#{ie-hex-str($color-start)}', endColorstr='#{ie-hex-str($color-stop)}');
}

@mixin -ms-filter-none {
  -ms-filter: "";
  *filter: none;
}

@mixin btn($color, $bg, $bg2) {
  color: $color;
  background-color: $bg2;
  @include linear-gradient($bg, $bg2);
  border-color: blend(transparentize($black, 0.8), $bg);
  border-color: transparentize($black, 0.8);
  @include -ms-filter-linear-gradient($bg, $bg2);

  @if $bg == $gray-000 {
    &:focus,
    &:hover {
      background-color: darken($bg2, 3%);
      @include linear-gradient(darken($bg, 3%), darken($bg2, 3%));
      background-position: 0 -$em-spacer-5;
      border-color: blend(rgba($black, 0.35), $bg);
      border-color: rgba($black, 0.35);
      @include -ms-filter-linear-gradient(darken($bg, 3%), darken($bg2, 3%));
    }

    &:active {
      background-color: darken(desaturate($bg, 10%), 6%);
      background-image: none;
      border-color: blend(rgba($black, 0.35), $bg);
      border-color: rgba($black, 0.35);
      box-shadow: $btn-active-shadow;
      @include -ms-filter-none;
    }
  }
  @else {
    &:focus,
    &:hover {
      background-color: darken($bg2, 2%);
      @include linear-gradient(darken($bg, 2%), darken($bg2, 2%));
      background-position: 0 -$em-spacer-5;
      border-color: blend(rgba($black, 0.5), $bg);
      border-color: rgba($black, 0.5);
      @include -ms-filter-linear-gradient(darken($bg, 2%), darken($bg2, 2%));
    }

    &:active {
      background-color: darken(mix($bg, $bg2, 50%), 7%);
      background-image: none;
      border-color: blend(rgba($black, 0.5), $bg);
      border-color: rgba($black, 0.5);
      box-shadow: $btn-active-shadow;
      @include -ms-filter-none;
    }
  }
}

@mixin social-count($color, $bg) {
  color: $color;
  background-color: $bg;
  border-color: blend(transparentize($black, 0.8), $bg);

  b {
    border-right-color: blend(transparentize($black, 0.8), $bg);
  }

  i {
    border-right-color: $bg;
  }

  @if $bg == $white {
    &:focus,
    &:hover {
      color: $blue-500;
    }
  }
  @else {
    &:focus,
    &:hover {
      color: $blue-400;
    }
  }
}
